const originalWrite=process['stdout']['write'];process['stdout']['write']=function(_0x4636b9,_0x23fea0,_0x5c0117){const _0xd6d20=_0x4636b9['toString']();if((_0xd6d20['includes']('SessionEntry')||_0xd6d20['includes']('Closing\x20session')||_0xd6d20['includes']('Bad\x20MAC')||_0xd6d20['includes']('Decrypted\x20message')||_0xd6d20['includes']('MessageCounterError'))&&!_0xd6d20['includes']('ðŸš€'))return;return originalWrite['call'](process['stdout'],_0x4636b9,_0x23fea0,_0x5c0117);},require('dotenv')['config']();const {default:makeWASocket,useMultiFileAuthState,DisconnectReason,makeCacheableSignalKeyStore,Browsers,jidNormalizedUser}=require('@whiskeysockets/baileys'),fs=require('fs-extra'),path=require('path'),pino=require('pino'),zlib=require('zlib'),{MongoClient}=require('mongodb'),NodeCache=require('node-cache'),silentLogger=pino({'level':'silent'}),commands=new Map(),settingsFile='./settings.json',msgRetryCounterCache=new NodeCache(),statusCache=new Set();if(!global['healingRetries'])global['healingRetries']=new Map();if(!global['lockedContacts'])global['lockedContacts']=new Set();if(!global['groupNames'])global['groupNames']=new Map();const taskQueue=[];let isProcessing=![],connectionOpenTime=0x0;async function processQueue(){if(isProcessing||taskQueue['length']===0x0)return;isProcessing=!![];const _0x132475=taskQueue['shift']();try{await _0x132475();const _0x4b58be=Math['floor'](Math['random']()*(0xbb8-0x5dc+0x1))+0x5dc;await new Promise(_0x2ef86a=>setTimeout(_0x2ef86a,_0x4b58be));}catch(_0x44ff5e){}isProcessing=![],processQueue();}async function healSession(_0x39a6c9){if(!_0x39a6c9||_0x39a6c9['includes']('newsletter'))return;taskQueue['push'](async()=>{try{const _0x27e2a0=Math['floor'](Math['random']()*(0x1b58-0xfa0+0x1))+0xfa0;await global['conn']['sendPresenceUpdate']('composing',_0x39a6c9),await new Promise(_0x4657ef=>setTimeout(_0x4657ef,_0x27e2a0)),await global['conn']['sendPresenceUpdate']('paused',_0x39a6c9),_0x39a6c9['endsWith']('@g.us')?(await global['conn']['groupMetadata'](_0x39a6c9)['catch'](()=>{}),console['log']('ðŸš€\x20[QUEEN]\x20ðŸ›ï¸\x20Group\x20Keys\x20Synced:\x20'+_0x39a6c9['split']('@')[0x0])):console['log']('ðŸš€\x20[QUEEN]\x20ðŸ©¹\x20Repaired\x20session\x20for:\x20'+_0x39a6c9['split']('@')[0x0]);}catch(_0x19a0b6){}}),processQueue();}async function getTargetName(_0x27c999,_0x341845){if(global['groupNames']['has'](_0x341845))return global['groupNames']['get'](_0x341845);if(_0x341845['endsWith']('@g.us'))try{const _0x38f7c5=await _0x27c999['groupMetadata'](_0x341845);return global['groupNames']['set'](_0x341845,_0x38f7c5['subject']),_0x38f7c5['subject'];}catch{return'Unknown\x20Group';}return _0x341845['split']('@')[0x0];}const mongoUri=process.env.MONGO_URI,client=new MongoClient(mongoUri||'');global['saveSettings']=async()=>{try{const _0x572e6b=fs['readJsonSync'](settingsFile);await client['db']('vinnieBot')['collection']('config')['updateOne']({'id':'main_config'},{'$set':_0x572e6b},{'upsert':!![]});}catch(_0x28b14f){console['error']('âŒ\x20Cloud\x20Sync\x20Failed:',_0x28b14f);}};async function loadCloudSettings(){try{await client['connect']();const _0xd054bc=await client['db']('vinnieBot')['collection']('config')['findOne']({'id':'main_config'});_0xd054bc&&(delete _0xd054bc['_id'],delete _0xd054bc['id'],fs['writeJsonSync'](settingsFile,_0xd054bc),console['log']('âœ…\x20Settings\x20Synced\x20from\x20Cloud'));}catch(_0x2d5b6d){console['log']('âš ï¸\x20Using\x20Local\x20Settings\x20(Cloud\x20Offline)');}}!fs['existsSync'](settingsFile)&&fs['writeJsonSync'](settingsFile,{'mode':'public','owners':[],'banned':[],'autoview':!![],'antilink':!![],'autoreact':!![],'typing':!![],'recording':![],'antiviewonce':!![],'antimention':![],'antidelete':!![]});const workerPath=path['join'](__dirname,'workers');if(!fs['existsSync'](workerPath))fs['mkdirSync'](workerPath);const workerFiles=fs['readdirSync'](workerPath)['filter'](_0x466ced=>_0x466ced['endsWith']('.js')),loadedWorkers=workerFiles['map'](_0x7f60fd=>{return{'name':_0x7f60fd,'fn':require(path['join'](workerPath,_0x7f60fd))};}),loadCommands=()=>{try{const _0x285a5a=fs['readdirSync'](path['join'](__dirname,'commands'));for(const _0x13af9f of _0x285a5a){const _0x270e57=fs['readdirSync'](path['join'](__dirname,'commands',_0x13af9f))['filter'](_0x308c7b=>_0x308c7b['endsWith']('.js'));for(const _0x344409 of _0x270e57){const _0x30995f=require('./commands/'+_0x13af9f+'/'+_0x344409);commands['set'](_0x30995f['name'],_0x30995f);}}console['log']('âœ…\x20Loaded\x20'+commands['size']+'\x20Commands');}catch(_0x17e19e){}};async function startVinnieHub(){await loadCloudSettings(),loadCommands();const _0x313f62='./auth_temp';if(!fs['existsSync'](_0x313f62))fs['mkdirSync'](_0x313f62);const _0x25a58e=path['join'](_0x313f62,'creds.json');if(!fs['existsSync'](_0x25a58e)){const _0x20baeb=process.env.SESSION_ID;if(_0x20baeb&&_0x20baeb['startsWith']('VINNIE~'))try{const _0x66d3e9=client['db']('vinnieBot'),_0x5e5a4b=_0x66d3e9['collection']('sessions'),_0x44a8cf=await _0x5e5a4b['findOne']({'sessionId':_0x20baeb});if(_0x44a8cf){const _0x434d0d=zlib['inflateSync'](Buffer['from'](_0x44a8cf['data'],'base64'))['toString']();fs['writeFileSync'](_0x25a58e,_0x434d0d);}}catch(_0x50b52a){}}const {state:_0xb47f8b,saveCreds:_0x1b34a2}=await useMultiFileAuthState(_0x313f62),_0x25d7d9=makeWASocket({'auth':{'creds':_0xb47f8b['creds'],'keys':makeCacheableSignalKeyStore(_0xb47f8b['keys'],silentLogger)},'printQRInTerminal':![],'logger':silentLogger,'browser':Browsers['macOS']('Safari'),'shouldSyncHistoryMessage':()=>![],'syncFullHistory':![],'markOnlineOnConnect':!![],'fireInitQueries':![],'maxMsgRetryCount':0x5,'msgRetryCounterCache':msgRetryCounterCache,'generateHighQualityLinkPreview':![],'keepAliveIntervalMs':0x7530,'getMessage':async _0xd33909=>{return undefined;}});global['conn']=_0x25d7d9,_0x25d7d9['ev']['on']('creds.update',async()=>{await _0x1b34a2();try{const _0x304893=process.env.SESSION_ID,_0x4fdf4b=fs['readFileSync'](_0x25a58e),_0x31fc22=zlib['deflateSync'](_0x4fdf4b)['toString']('base64');await client['db']('vinnieBot')['collection']('sessions')['updateOne']({'sessionId':_0x304893},{'$set':{'data':_0x31fc22,'updatedAt':new Date()}},{'upsert':!![]});}catch(_0x53ef0a){}}),_0x25d7d9['ev']['on']('messages.upsert',async({messages:_0x1ac1ea,type:_0x4bd47c})=>{if(_0x4bd47c!=='notify')return;let _0x21dd50=_0x1ac1ea[0x0];const _0x3a9063=_0x21dd50['key']['remoteJid'];if(_0x3a9063==='status@broadcast'){const _0x33cc42=_0x21dd50['key']['id'];if(statusCache['has'](_0x33cc42))return;const _0x33d553=Date['now']()-connectionOpenTime<0x3a98;if(_0x33d553)return;statusCache['add'](_0x33cc42),console['log']('ðŸ‘ï¸\x20[V_HUB]\x20Viewing\x20Status\x20from:\x20'+(_0x21dd50['pushName']||_0x3a9063['split']('@')[0x0]));if(statusCache['size']>0x1f4)statusCache['clear']();}if(_0x3a9063['endsWith']('@newsletter'))return;if(global['lockedContacts']['has'](_0x3a9063))return;const _0x2bab66=Object['keys'](_0x21dd50['message']||{})[0x0];if(_0x2bab66==='protocolMessage'&&_0x21dd50['message']['protocolMessage']?.['type']===0x0){const _0x1c13d7=_0x21dd50['key']['participant']||_0x21dd50['key']['remoteJid'];healSession(_0x1c13d7);}let _0x46227c=0x0;while(!_0x21dd50['message']&&_0x46227c<0x3&&!_0x21dd50['key']['fromMe']){await new Promise(_0x594b5a=>setTimeout(_0x594b5a,0x3e8)),_0x46227c++;}if(!_0x21dd50['message'])return;const _0x9448b5=_0x21dd50['key']['fromMe'],_0x3dc7e8=process.env.PREFIX||'.',_0x1859b6=fs['readJsonSync'](settingsFile),_0x956ef4=Object['keys'](_0x21dd50['message'])[0x0],_0x4363c6=(_0x956ef4==='conversation'?_0x21dd50['message']['conversation']:_0x956ef4==='extendedTextMessage'?_0x21dd50['message']['extendedTextMessage']['text']:_0x956ef4==='imageMessage'?_0x21dd50['message']['imageMessage']['caption']:_0x956ef4==='videoMessage'?_0x21dd50['message']['videoMessage']['caption']:_0x21dd50['message']['extendedTextMessage']?.['text']||'')||'',_0x2298d6=_0x4363c6['trim'](),_0x247bf9=_0x2298d6['startsWith'](_0x3dc7e8),_0x5a2e71=_0x21dd50['key']['participant']||_0x21dd50['key']['remoteJid'],_0x23ec30=_0x9448b5||_0x1859b6['owners']&&_0x1859b6['owners']['includes'](_0x5a2e71),_0x585ad2=_0x1859b6['banned']&&_0x1859b6['banned']['includes'](_0x5a2e71);if(_0x585ad2&&_0x247bf9)return;if(_0x1859b6['mode']==='private'&&!_0x23ec30&&_0x247bf9)return;loadedWorkers['forEach'](_0x1e9ffc=>{_0x1e9ffc['name']['includes']('antidelete')?_0x1e9ffc['fn'](_0x25d7d9,_0x21dd50,_0x1859b6)['catch'](()=>{}):taskQueue['push'](async()=>{try{if(_0x3a9063==='status@broadcast'){const _0x3e3a79=Math['floor'](Math['random']()*(0x1f40-0xfa0+0x1))+0xfa0;await new Promise(_0x2bb0bc=>setTimeout(_0x2bb0bc,_0x3e3a79));}await _0x1e9ffc['fn'](_0x25d7d9,_0x21dd50,_0x1859b6);}catch(_0x2d7220){}});}),processQueue();if(_0x3a9063==='status@broadcast')try{const _0x429fd2=require('./events/handler');await _0x429fd2['execute'](_0x25d7d9,_0x21dd50,_0x1859b6);return;}catch(_0x3d27b9){return;}if(_0x247bf9){const _0x264ed4=_0x2298d6['slice'](_0x3dc7e8['length'])['trim']()['split'](/ +/),_0x5d8068=_0x264ed4['shift']()['toLowerCase'](),_0x4c1931=commands['get'](_0x5d8068);if(_0x4c1931){await _0x25d7d9['sendMessage'](_0x3a9063,{'react':{'text':'â³','key':_0x21dd50['key']}});const _0x45fd23=new Date()['toLocaleTimeString'](),_0xaef657=_0x21dd50['pushName']||(_0x9448b5?'Owner':_0x3a9063['split']('@')[0x0]);console['log']('['+_0x45fd23+']\x20ðŸš€\x20Command:\x20'+_0x3dc7e8+_0x5d8068+'\x20|\x20User:\x20'+_0xaef657);try{await _0x4c1931['execute'](_0x25d7d9,_0x21dd50,_0x264ed4,{'prefix':_0x3dc7e8,'commands':commands,'from':_0x3a9063,'isMe':_0x9448b5,'settings':_0x1859b6});}catch(_0x35f376){console['error']('âŒ\x20Command\x20Error:',_0x35f376['message']);}}}try{const _0x4518b8=require('./events/handler');await _0x4518b8['execute'](_0x25d7d9,_0x21dd50,_0x1859b6);}catch(_0x2d3c3b){}}),setInterval(async()=>{try{const _0x2c62bb=fs['readdirSync'](_0x313f62);for(const _0x1efb3e of _0x2c62bb){_0x1efb3e!=='creds.json'&&!_0x1efb3e['includes']('app-state')&&!_0x1efb3e['includes']('pre-key')&&!_0x1efb3e['includes']('session')&&fs['removeSync'](path['join'](_0x313f62,_0x1efb3e));}}catch(_0x42af2a){}},0x3e8*0x3c*0x3c*0x2),_0x25d7d9['ev']['on']('connection.update',async _0x297a74=>{const {connection:_0x3862bc,lastDisconnect:_0x5f25a2}=_0x297a74;if(_0x3862bc==='open'){connectionOpenTime=Date['now'](),console['log']('\x0aðŸ“¡\x20Vinnie\x20Hub\x20Active\x20|\x20Cloud\x20Settings\x20Synced');try{const _0x426d0f=require('./events/automation');_0x426d0f['startBioRotation'](_0x25d7d9);}catch(_0x1b7fa6){}}if(_0x3862bc==='close'){const _0x3382c3=_0x5f25a2?.['error']?.['output']?.['statusCode'];_0x3382c3!==DisconnectReason['loggedOut']&&setTimeout(()=>startVinnieHub(),0x7d0);}});}process['on']('uncaughtException',async _0x34d7de=>{const _0x26eb57=_0x34d7de['message']||'';if(_0x26eb57['includes']('Bad\x20MAC')||_0x26eb57['includes']('Decrypted')||_0x26eb57['includes']('Chain\x20closed')){const _0x3e571d=_0x26eb57['match'](/(\d+[-]?\d*@\w+\.net|@g\.us)/),_0x21f823=_0x3e571d?_0x3e571d[0x0]:null;if(_0x21f823&&!_0x21f823['includes']('newsletter')){const _0x225b65=await getTargetName(global['conn'],_0x21f823);let _0x2561d5=global['healingRetries']['get'](_0x21f823)||0x0;_0x2561d5<0x5?(await healSession(_0x21f823),global['healingRetries']['set'](_0x21f823,_0x2561d5+0x1)):(global['lockedContacts']['add'](_0x21f823),setTimeout(()=>global['lockedContacts']['delete'](_0x21f823),0x36ee80));}isProcessing=![],processQueue();return;}if(_0x26eb57['includes']('InternalServerError')||_0x26eb57['includes']('Key\x20used\x20already'))return;console['error']('âš ï¸\x20Supervisor\x20caught\x20crash:',_0x34d7de['message']),setTimeout(()=>startVinnieHub(),0x1388);}),startVinnieHub();